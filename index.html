<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eiendomsskatt Kalkulator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #resultat {
            font-size: 20px;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>Eiendomsskatt Kalkulator</h1>
    <label for="markedsverdi" style="font-size:20px;">Markedsverdi på boligen (i kroner):</label>
    <input 
        type="text" 
        id="markedsverdi" 
        title="Bare tall er tillatt" 
        oninput="this.value = this.value.replace(/[^0-9\.,]/g, '').replace(',', '.').replace(/\B(?=(\d{3})+(?!\d))/g, ' ');">
    </input>
    <br><br>
    <button onclick="beregnEiendomsskatt()">Beregn eiendomsskatt</button>
    <button onclick="location.reload()">Nullstill</button>
    <p id="resultat"></p>
    <hr>
    <p style="font-size:22px;">
        Utregning: (Markedsverdi * 0,7 (verdirabatt) - 500 000 (bunnfradrag)) * aktuell promille = Eiendomsskatt.
    </p>
    <hr>

    <script>
        const VERDIRABATT = 0.7; // 30% verdirabatt
        const BUNNFRADRAG = 500000; // Bunnfradrag på 500 000 kroner

        function beregnEiendomsskatt() {
            const markedsverdiInput = document.getElementById("markedsverdi").value.replace(/ /g, '');
            const markedsverdi = parseFloat(markedsverdiInput);

            if (isNaN(markedsverdi) || markedsverdi <= 0) {
                document.getElementById("resultat").innerHTML = "Vennligst oppgi en gyldig markedsverdi.";
                document.getElementById("resultat").style.backgroundColor = "#F2EBDD";
                return;
            }

            const justertMarkedsverdi = markedsverdi * VERDIRABATT;
            const nettoVerdi = Math.max(justertMarkedsverdi - BUNNFRADRAG, 0);

            // Bestem promillen basert på året
            let promille = 0.001; // 1 promille første året
            const år = new Date().getFullYear(); // Juster basert på aktuelt år
            if (år === 2024) {
                promille = 0.002; // 2 promille andre året
            } else if (år >= 2025) {
                promille = 0.0028; // 2,8 promille tredje året og fremover
            }

            const eiendomsskatt = nettoVerdi * promille;

            if (eiendomsskatt > 0) {
                document.getElementById("resultat").innerHTML = 
                    `Eiendomsskatten for boligen er <b>${eiendomsskatt.toFixed(2)} kr</b> basert på en promille på ${promille * 1000}.`;
                document.getElementById("resultat").style.backgroundColor = "#DFF2BF";
            } else {
                document.getElementById("resultat").innerHTML = 
                    "Ingen eiendomsskatt gjelder for denne boligen.";
                document.getElementById("resultat").style.backgroundColor = "#F2EBDD";
            }
        }
    </script>
</body>
</html>
